<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Proxy Dashboard</title><style>body{font-family:Arial;max-width:1200px;margin:0 auto;padding:20px;background:#f5f5f5}.card{background:#fff;border-radius:8px;padding:20px;margin:20px 0;box-shadow:0 2px 4px rgba(0,0,0,0.1)}select{padding:8px;border-radius:4px;border:1px solid #ddd;font-size:14px;min-width:180px}button{background:#4CAF50;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer}.info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}.info-item{padding:10px;background:#f9f9f9;border-radius:4px}</style></head><body><h1>Proxy Dashboard</h1><div class="card"><h2>Provider Availability</h2><div class="info-grid" id="status">Loading...</div></div><div class="card"><h2>Routing</h2><div><label>Sonnet:</label><select id="sp"><option value="antigravity">Antigravity</option><option value="glm">GLM</option><option value="anthropic">Anthropic</option></select><select id="sm"></select></div><div><label>Haiku:</label><select id="hp"><option value="antigravity">Antigravity</option><option value="glm">GLM</option><option value="anthropic">Anthropic</option></select><select id="hm"></select></div><div><label>Opus:</label><select id="op"><option value="antigravity">Antigravity</option><option value="glm">GLM</option><option value="anthropic">Anthropic</option></select><select id="om"></select></div><button onclick="apply()">Apply</button><div id="msg"></div></div><div class="card"><h2>Logs</h2><button onclick="copyLogs()">Copy</button><button onclick="clearLogs()">Clear</button><div id="logs" style="background:#0d1117;color:#c9d1d9;padding:15px;border-radius:6px;font-family:monospace;font-size:12px;max-height:500px;overflow-y:auto">Loading...</div></div><script>let cfg={},avail={},models={};async function load(){try{const r=await fetch("/config");const d=await r.json();cfg=d.config;avail=d.providers_available;models=d.available_models;document.getElementById("sp").value=cfg.sonnet_provider;document.getElementById("hp").value=cfg.haiku_provider;document.getElementById("op").value=cfg.opus_provider;pop("sonnet",cfg.sonnet_provider,cfg.sonnet_model);pop("haiku",cfg.haiku_provider,cfg.haiku_model);pop("opus",cfg.opus_provider,cfg.opus_model);document.getElementById("sp").onchange=(e)=>pop("sonnet",e.target.value);document.getElementById("hp").onchange=(e)=>pop("haiku",e.target.value);document.getElementById("op").onchange=(e)=>pop("opus",e.target.value);updateStatus()}catch(e){console.error(e)}}function pop(tier,prov,sel){const s=document.getElementById(tier[0]+"m");s.innerHTML="";const m=models[prov]||[];m.forEach(x=>{const o=document.createElement("option");o.value=x;o.textContent=x;s.appendChild(o)});if(sel&&m.includes(sel))s.value=sel;else if(m.length>0)s.value=m[0]}function updateStatus(){const s=document.getElementById("status");const p=[{n:"Antigravity",a:avail.antigravity},{n:"GLM",a:avail.glm},{n:"Anthropic",a:avail.anthropic},{n:"Copilot",a:avail.copilot}];s.innerHTML=p.map(x=>"<div class=info-item><div>"+x.n+"</div><div>"+(x.a?"Available":"Not Configured")+"</div></div>").join("")}async function apply(){const u={sonnet_provider:document.getElementById("sp").value,haiku_provider:document.getElementById("hp").value,opus_provider:document.getElementById("op").value,sonnet_model:document.getElementById("sm").value,haiku_model:document.getElementById("hm").value,opus_model:document.getElementById("om").value};try{const r=await fetch("/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});const d=await r.json();if(r.ok){document.getElementById("msg").textContent="Updated!";cfg=d.config}else{document.getElementById("msg").textContent="Error: "+d.error}}catch(e){document.getElementById("msg").textContent="Failed: "+e.message}}async function loadLogs(){try{const r=await fetch("/logs");const d=await r.json();const div=document.getElementById("logs");if(d.logs&&d.logs.length>0){div.innerHTML=d.logs.map(log=>{const c={INFO:"#58a6ff",WARNING:"#f0883e",ERROR:"#f85149",DEBUG:"#a371f7"}[log.level]||"#c9d1d9";const t=new Date(log.timestamp).toLocaleTimeString();const m=log.message.replace(/</g,"&lt;").replace(/>/g,"&gt;");return "<div style=margin-bottom:8px;padding:8px;border-left:3px solid "+c+"><span style=color:#8b949e>"+t+"</span> <span style=color:"+c+";font-weight:bold>["+log.level+"]</span> <span>"+m+"</span></div>"}).reverse().join("")}else{div.innerHTML="<div>No logs</div>"}}catch(e){console.error(e)}}function copyLogs(){fetch("/logs").then(r=>r.json()).then(d=>{if(d.logs){const t=d.logs.map(l=>new Date(l.timestamp).toISOString()+" ["+l.level+"] "+l.message).reverse().join("\n");navigator.clipboard.writeText(t)}})}function clearLogs(){document.getElementById("logs").innerHTML="<div>Cleared. Will reload...</div>"}load();loadLogs();setInterval(load,10000);setInterval(loadLogs,3000)</script></body></html>
