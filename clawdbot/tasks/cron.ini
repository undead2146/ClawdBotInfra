# ============================================================
# Ofelia Cron Configuration
# ============================================================
# Ofelia is a Docker-native cron job scheduler
# Documentation: https://github.com/mcuadros/ofelia
# ============================================================

# Global Ofelia configuration
[global]
# Check for new jobs every second
checkInterval = 1

# ============================================
# Job Definitions
# ============================================
# Format: [job-exec "job-name"]
# schedule = cron expression (min hour day month weekday)
# container = target container name
# command = command to execute in container
# ============================================

# --------------------------------------------
# Daily PR Review (9 AM daily)
# --------------------------------------------
[job-exec "daily-pr-review"]
schedule = 0 9 * * *
container = clawdbot
command = claude "Review all open PRs in /workspace. For each, check for bugs, security issues, and code quality. Post a summary comment to each PR." --dangerously-skip-permissions
# Remove the # below to enable:
# enable = true

# --------------------------------------------
# Weekly Issue Cleanup (Monday 10 AM)
# --------------------------------------------
[job-exec "weekly-issue-cleanup"]
schedule = 0 10 * * 1
container = clawdbot
command = claude "List all stale issues older than 30 days in /workspace. For each, draft a comment asking for status updates. Tag issues needing attention with 'stale'." --dangerously-skip-permissions
# enable = true

# --------------------------------------------
# Nightly Backup (2 AM daily)
# --------------------------------------------
[job-exec "nightly-backup"]
schedule = 0 2 * * *
container = clawdbot
command = /prompts/scripts/backup-workspace.sh
# enable = true

# --------------------------------------------
# Weekly Dependency Check (Wednesday 11 AM)
# --------------------------------------------
[job-exec "weekly-dependency-check"]
schedule = 0 11 * * 3
container = clawdbot
command = claude "Check all repositories in /workspace for outdated dependencies. Generate a report with security vulnerabilities flagged prominently." --dangerously-skip-permissions
# enable = true

# --------------------------------------------
# Daily Summary (5 PM daily)
# --------------------------------------------
[job-exec "daily-summary"]
schedule = 0 17 * * *
container = clawdbot
command = claude "Generate a daily summary of all activity (commits, issues, PRs) across repositories in /workspace. Save to /workspace/summaries/daily-{date}.md" --dangerously-skip-permissions
# enable = true

# --------------------------------------------
# Hourly Health Check
# --------------------------------------------
[job-exec "health-check"]
schedule = 0 * * * *
container = clawdbot
command = curl -f http://proxy:8082/health || echo "Proxy health check failed"
enable = true
